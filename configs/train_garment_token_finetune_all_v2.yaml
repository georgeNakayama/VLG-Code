# Training configuration for Pattern Shape prediction model 
# (part I of NeuralTailor)

# 0.5 * stitch cls loss (focal loss) + 0.005 * stitch ce loss + 5 * panel loss
defaults: 
  - data_wrapper: finetune_garment_token_data_wrapper_v2
  - model: gpt2
  - trainer: garment_token_trainer
  - system: my_system
  - experiment: gpt2_experiment
  - _self_

model:
  _target_: models.decoders.lora_gpt2.GPT
  ignore_index: null  # ignore padding token
  block_size: 1024
  new_vocab_size: ${eval:'${..data_wrapper.dataset.bin_size} + 4 + 4'} # 256 bin + 4 panel tokens + 4 commands
  lora_attn_dim: 0
  lora_attn_alpha: 32
  lora_attn_dropout: 0.1
  lora_embd_dim: 0

experiment:
  run_name: finetune_garment_token_all_v2


test_only: False
random_seed: 42
pre_trained: null
storage_dir: null
from_pretrained: gpt2